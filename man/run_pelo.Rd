% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/functions_PELO.R
\name{run_pelo}
\alias{run_pelo}
\title{Run PELO Rating Updates Across a Dataset}
\usage{
run_pelo(
  KK2,
  data,
  current_ratings,
  current_pair_adv_mat,
  player_id_mapping,
  new_player_initial_rating = 1500,
  keep_history = FALSE
)
}
\arguments{
\item{KK2}{Numeric vector of length 2: \code{1} = Elo K, \code{2} = P-Elo K2}

\item{data}{A dataframe of match results with columns: \code{Time}, \code{A}, \code{B}, \code{match_result}.
\code{match_result} must be binary: 1 if player A won, 0 if player B won.}

\item{current_ratings}{Dataframe with columns \code{Player} and \code{Ratings} containing the
current ratings of all players.}

\item{current_pair_adv_mat}{Numeric square matrix of pairwise advantages between players,
with row and column names corresponding to player names.}

\item{player_id_mapping}{Dataframe with columns \code{Names} and \code{ID} mapping player names to unique IDs.}

\item{new_player_initial_rating}{Numeric, the initial rating assigned to any new players
not in the current ratings (default 1500).}

\item{keep_history}{TRUE/FALSE, whether to keep the rating history. Memory issues may arise when the number of players and number of games are large.}
}
\value{
A list containing:
\describe{
\item{ratings}{Dataframe of final ratings after all matches.}
\item{ratings_hist}{List of ratings after each match.}
\item{pair_adv}{Final pairwise advantage matrix.}
\item{pair_adv_hist}{List of pairwise advantage matrices after each match.}
\item{K}{Numeric, Elo K-factor used for ratings updates.}
\item{K2}{Numeric, P-Elo K2-factor used for pairwise advantage updates.}
\item{type}{Character, always "PELO".}
\item{preds}{Numeric vector of predicted probabilities for each match outcome.}
\item{player_id_mapping}{Updated dataframe mapping player names to IDs including any new players.}
}
}
\description{
Sequentially updates PELO ratings for all matches in a dataset, including pairwise
advantages, and tracks predicted probabilities and full rating history. Supports
dynamically adding new players that appear in the dataset.
}
\details{
The function loops over all matches in the dataset, updating player ratings and
pairwise advantages sequentially. If new players appear in the dataset, they are
added to the ratings and pairwise advantage matrix with the specified initial rating
and zero initial pairwise advantage. Predicted probabilities for each match are
computed based on the PELO formula.
}
\examples{
# Suppose df contains match data, ratings contains current ratings,
# pair_adv_mat contains pairwise advantages, and player_id_mapping exists
# run_pelo(c(32,16), df, ratings, pair_adv_mat, player_id_mapping)

}
